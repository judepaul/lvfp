<div class="row" style="height:60px;"></div>

<%#= render 'form', speech: @speech %>

<div class="container">
    <div class="container-fluid px-0">
        <div class="row no-gutters">
            <div class="col-sm-12 col-md mr-md-3">
              <div class="card">
                        <div class="card-header text-white h5">
                          <div class="row">
                              <div class="col-md-6">Manage Articles</div>
                              <div class="col-md-6 text-right">
                                <span style="cursor: pointer;" class="article-show"><i class="fas fa-info-circle fa-lg"></i></span>
                              </div>
                            </div>
                        </div>
                    <div class="card-body"><!-- <p id="notice"><%= notice %></p> -->
<div id="accordion">
  <% unless @access_codes.blank?
        @access_codes.each_with_index do |ac,indx|
  %>
  <div class="card">
    <div class="card-header" id="heading<%=indx+1%>" class="btn btn-link" data-toggle="collapse" data-target="#collapse<%=indx+1%>" aria-expanded="true" aria-controls="collapse<%=indx+1%>" style="color: #FFF !important; text-decoration: none !important; padding: 10px; !important;">
      <div class="row">
      <div class="col-md-11 pl-4"> Campaign: <%= ac.title.titlecase %> | Listener Group Access Code: <%= ac.code %></div>
      <!-- <div class="col-md-6 text-right" style="padding-right:20px;"><h6>Published Articles - <%#= articlel_count ac.id %></h6></div> -->
        <div class="col-md-1" style="padding:3px 40px 0 0;"><i class="fas fa-plus float-right "></i></div>
      </div>
    </div>
    <%# <% if indx==0 %>
        <!-- <div id="collapse<%=indx+1%>" class="collapse show" aria-labelledby="heading<%=indx+1%>" data-parent="#accordion"> -->
    <%# <% else %>
    <% unless @group_code.blank? %>
        <% if @group_code.to_i == ac.id %>
                  <div id="collapse<%=indx+1%>" class="collapse show" aria-labelledby="heading<%=indx+1%>" data-parent="#accordion">
        <% else %>
                <div id="collapse<%=indx+1%>" class="collapse" aria-labelledby="heading<%=indx+1%>" data-parent="#accordion">
        <% end %>
    <% else %>

    <!-- Commented by Jude on 25/03/2020 to show all tabs as discussed with Gaurav on 24/03/2020(keep the pane all tabs expand) -->
            <!%if indx==0 %>
        <div id="collapse<%=indx+1%>" class="collapse show" aria-labelledby="heading<%=indx+1%>" data-parent="#accordion"> 
    <!% else %>
            <!-- <div id="collapse<%#=indx+1%>" class="collapse" aria-labelledby="heading<%#=indx+1%>" data-parent="#accordion"> -->
      
      <!% end %>
    <% end %>
    <div class="card-body table-responsive">
    <% if ac.access_code_speech_map.blank? %>
      <div class="row" style="height:60px"></div>
      <div class="col-md-8 offset-md-4 align-self-center">  <%= link_to 'Create your first Article', new_speech_path, class: 'btn btn-outline-primary' %></div>
    <% else %>
        <% speech_arr = [] %>
        <% ac.access_code_speech_map.each do |acsm|
            speech_arr << acsm.speech 
            end    
        %>
        <table class="table table-bordered table-sm table-hover">
          <thead class="thead-light h5 font-weight-bold">
            <tr>
              <th scope="col">Articles (<%= speech_arr.length %>)</th>
            </tr>
          </thead>
        <% speech_arr.sort_by(&:updated_at).reverse.each_with_index do |speech,indx| %>
          <tbody class="h6">
            <tr style="cursor: pointer;font-size:18px;">
              <td><p class="content">Title: <%= !speech.title.blank? ? speech.title : 'N/A' %> 
                <!-- <span style="padding: 1px 5px 1px 5px; color:#FFF; background-color: <%#= speech.published? ? 'green' : !speech.published? ? 'orange' : "" %>;"><strong><%#= speech.published? ? 'Published' : !speech.published? ? 'Draft' : "" %></strong></span> -->
                <span style="padding: 2px 5px 1px 2px;">
                  <% if speech.published? %>
                    <%= link_to("/speeches/published_details/#{speech.id}",style:"text-decoration:none;",class:"btn btn-outline-success px-1 py-0") do %><i class="fas fa-link fa-1x"></i> Published<% end %> 
                    <span style="float: right; padding-right:10px; font-size:16px; letter-spacing:0px; font-weight:bold;"> <%= image_tag 'icon-calendar', alt: "calendar" %> <%= speech.updated_at.strftime("%m/%d/%Y") %></span>
                  <% else %> 
                    <span class="btn btn-outline-warning px-1 py-0">Draft</span>
                    <span style="float: right; padding-right:10px; font-size:16px; letter-spacing:0px; font-weight:bold;"> <%= image_tag 'icon-calendar', alt: "calendar" %> <%= speech.updated_at.strftime("%m/%d/%Y") %></span>
                  <% end %>
                </span>
                </p>
                <p class="content"><%= !speech.email_from.blank? ? speech.email_from.rstrip.concat('.') : '' %> <%= speech.content %></p>
                <div class="actions" style="display:none; float:right;">
                  <i class="fas fa-edit btn btn-secondary" style="padding:10px!important;background-color:#61318f !important; border-color:#61318f !important;" onclick="location.href='<%= edit_speech_path(speech) %>'"></i>
                  <a href="/speeches/<%=speech.id%>" data-method="delete" data-confirm="<%= speech.published? ? 'This article is already published. Are you sure you want to delete?' : 'Are you sure you want to delete this article?' %>" data-title='Confirm Deletion' data-commit='Yes do it!' data-cancel='Not really!'  class='btn btn-secondary delete-speech' style="background-color:#61318f !important; border-color:#61318f !important;" id="delete-btn">
                    <i class="fas fa-trash-alt"></i></a>
                  </div>

              </td>
            </tr>
          </tbody>
        <% end %>
        </table>
      </div>
    <% end %>
    </div>

  </div>
  <br/>
  <% end
    end
  %>
  <br/>
  <div class="row">
    <% unless @speeches.blank? %>
  		<div class="actions text-right col-md-12" style="padding:30px 10px 0 30px; bottom: 0; right: 0;">
  			<%= link_to 'Add Article', new_speech_path, class: 'btn btn-outline-primary' %>
		  </div>
      <% end %>
	</div>
<br/>
	
</div>
</div>

</div>
</div>
</div>
</div>
</div>
<%#= link_to 'New Speech', new_speech_path %>
<br/>



<!-- Modal -->
<div class="modal fade" id="contentModal" data-keyboard="false" data-backdrop="static" tabindex="-1" role="dialog" aria-labelledby="contentModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
          <div class="col-md-6">
            <h5 class="modal-title" id="exampleModalLabel">Content</h5>
          </div>
          <div class="col-md-3 text-right" >
            <!-- <audio id="audioPlayback" controls> -->
            <audio id="audioPlayback">
              <source id="audioSource" type="audio/mp3" src="">
            </audio>
            <button type="button" class="close close-modal" data-dismiss="modal" aria-label="Close" data-toggle="tooltip" data-placement="top" title="Close">
              <i class="fa fa-times-circle fa-lg"></i> 
            </button>
            <button type="button" class="close audioPlayback play" onclick="aud_play_pause()" style="outline:none !important; padding-right:15px;"><span><i class="fa fa-play-circle fa-lg" aria-hidden="true"></i></span></button>
            </div>
      </div>
      <input type="hidden" id="speech_content" />
      <div id="contentDetails" class="modal-body">
        
      </div>
      <div class="modal-footer">
        <div class="col-md-6">
          <button type="button" class="btn btn-outline-danger delete_speech" id="delete-btn">Delete</button>
          <%#= link_to 'Delete', '', method: :delete, :class => 'btn btn-outline-danger delete-speech', id: "delete-btn" %>
          <div class="panel panel-default" style="text-align:left;padding-top:15px;display:none;" id="delete-confirm-pane">
	<div class="panel-heading"><h6>Confirmation</h6></div>
		<div class = "panel-body"></div>
    Are you sure you want to delete this Article?
    <div style="padding:10px 60px 0 0;"align="right""><button type="button" class="btn btn-outline-primary" id="delete-confirm-cancel">Cancel</button>
		  <!-- <button type="button" class="btn btn-primary hide" id="btn2">Ok</button> -->
      <%= link_to 'Ok', '', method: :delete, :class => 'btn btn-outline-danger delete-speech' %>
    </div>
	</div>
        </div>
        <div class="col-md-6 offset-md-5 text-right">
          <button type="button" class="btn btn-outline-primary close-modal" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal -->
<div class="modal fade" id="FAQcontentModal-article" data-keyboard="false" data-backdrop="static" tabindex="-1" role="dialog" aria-labelledby="contentModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
          <div class="col-md-6">
            <h5 class="modal-title" id="exampleModalLabel">FAQ</h5>
          </div>
          <div class="col-md-3 text-right" >
            <!-- <audio id="audioPlayback" controls> -->
            <audio id="audioPlayback">
              <source id="audioSource" type="audio/mp3" src="">
            </audio>
            <button type="button" class="close close-modal" data-dismiss="modal" aria-label="Close" data-toggle="tooltip" data-placement="top" title="Close">
              <i class="fa fa-times-circle fa-lg"></i> 
            </button>
            </div>
      </div>
      <input type="hidden" id="speech_content" />
      <div id="contentDetails" class="modal-body">
        <%= render "layouts/shared/faq" %>
      </div>
      <div class="modal-footer">
        <div class="col-md-6"></div>
        <div class="col-md-6 offset-md-5 text-right">
          <button type="button" class="btn btn-outline-primary close-modal" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>
</div>